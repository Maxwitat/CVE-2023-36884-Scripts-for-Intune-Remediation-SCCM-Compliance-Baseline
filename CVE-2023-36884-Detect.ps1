# Check for Mitigation of Office vulneribility reg entries, https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-36884
# Script is provided AS-IS without any warranty

function Test-RegistryValue {
    param (
        [parameter(Mandatory = $true)][ValidateNotNullOrEmpty()][string]$Path,
        [parameter(Mandatory = $true)][ValidateNotNullOrEmpty()][string]$Value,
        [switch]$ShowValue
    )
    try {
        $Values = Get-ItemProperty -Path $Path | select-object -ExpandProperty $Value -ErrorAction Stop 
        if ($ShowValue) {
            $Values
        }
        else {
            $true
        }
         
    }
    catch {
        $false
    }
}

$key = "HKLM:\SOFTWARE\Policies\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BLOCK_CROSS_PROTOCOL_FILE_NAVIGATION"
if(!(Test-Path $key)){
    exit 1
}
else{
    $res = Test-RegistryValue -Value Winword.exe -Path $key
    if($res){
        exit 0
    }
    else
    {
        exit 1
    }
}